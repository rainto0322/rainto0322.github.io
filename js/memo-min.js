class Memo{constructor(t){this.el=document.querySelector(t.el),this.url=t.url,this.img=t.img?`<img src="${t.img}">`:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24px" height="30px" fill="#333"><rect x="0" y="0" width="4" height="15"><animate attributeName="opacity" values="1;.2;1" begin="0s" dur="0.6s" repeatCount="indefinite"></animate></rect><rect x="10" y="0" width="4" height="15"><animate attributeName="opacity" values="1;.2;1" begin="0.2s" dur="0.6s" repeatCount="indefinite"></animate></rect><rect x="20" y="0" width="4" height="15"><animate attributeName="opacity" values="1;.2;1" begin="0.4s" dur="0.6s" repeatCount="indefinite"></animate></rect></svg>',this.cpage=0,this.init()}$(t){return this.el.querySelector(t)}T(t){const e=new Date(t),i=t=>String(t).padStart(2,"0"),[n,a,r,s,o]=[e.getFullYear(),i(e.getMonth()+1),i(e.getDate()),i(e.getHours()),i(e.getMinutes())];return`${n}-${a}-${r} ${s}:${o}`}cr(t){return document.createElement(t)}async init(){this.el.innerHTML='<div id="memo-cont"></div><div id="memo-more" style="text-align:center;padding:2em"></div>',this.$("#memo-more").innerHTML=this.img,this.FD()}async FD(){const t=await fetch(`${this.url}/memo/li/${this.cpage}/10`);t.ok||setTimeout((()=>{this.el.innerHTML="•︡ᯅ•︠ Unable connect to radio waves."}),2e3),this.RD(await t.json())}RD(t){const{data:e,max:i}=t,n=document.createDocumentFragment();for(const t of e){let{text:e,img:i,date:a}=t;const r=this.cr("div");r.className="m-item";let s=this.cr("div");s.className="i-cont";const o=this.cr("time");o.innerHTML=`<div class="i-meta"><time datetime="${a}">${this.T(a)}</time></div>`;const m=(new DOMParser).parseFromString(e.replace(/\n/g,"<br>"),"text/html").body.innerHTML;i.length>=1?s.innerHTML=`<img src="https://raw.gitcode.com/rainto/Album/raw/main/daily/${i[0]}.png">`+m:s.innerHTML=m,r.appendChild(s),r.appendChild(o),n.appendChild(r)}const a=this.$("#memo-more");if(this.cpage+1<i){const t=this.cr("div");t.textContent="ʕ•ᴥ•ʔ Click me to load more.",t.onclick=()=>{a.innerHTML=this.img,this.loadMore()},a.innerHTML="",a.appendChild(t)}else a.innerHTML="૮₍•́₃•̀₎ა Really not a drop left.";this.$("#memo-cont").appendChild(n)}loadMore(){this.cpage+=1,this.FD()}}